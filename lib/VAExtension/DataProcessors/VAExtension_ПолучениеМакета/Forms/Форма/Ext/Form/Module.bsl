#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ПолучитьЗначениеМакета(Команда)
	
	Окна = ПолучитьОкна();
	Результат = Новый Массив;
	
	ОкноНайдено = Ложь;
	Для Каждого ТекОкно Из Окна Цикл
		Если ТекОкно.Заголовок = ЗначениеЗаголовокОкна Тогда
			Если ТекОкно.Содержимое.Количество() > 0 Тогда
				ОкноНайдено = Истина;
				ИмяРеквизита = ТекОкно.Содержимое[0].Элементы[ЗначениеИмяЭлементаФормы].Имя;
				ТабДок = ТекОкно.Содержимое[0][ИмяРеквизита];
				ВывестиТабличныйДокументКакСтроку(ТабДок);
				Прервать;
			КонецЕсли;	 
		КонецЕсли;	 
	КонецЦикла;
	
	Если НЕ ОкноНайдено Тогда
		ТекстСообщения = НСтр("ru = 'Не найдено окно <%1>'");
		ТекстСообщения = СтрЗаменить(ТекстСообщения, "%1", ЗначениеЗаголовокОкна);
		ВызватьИсключение ТекстСообщения
	КонецЕсли;	
	
	ВыражениеВычислено = Истина;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервереБезКонтекста
Функция ВывестиТабличныйДокументКакСтрокуСервер(ТабДок)
	
	ПотокФайла = Новый ПотокВПамяти();
	ТабДок.Записать(ПотокФайла);
	ДвоичныеДанные = ПотокФайла.ЗакрытьИПолучитьДвоичныеДанные(); 

	ЗаписьXML = Новый ЗаписьXML;
	ЗаписьXML.УстановитьСтроку();
	СериализаторXDTO.ЗаписатьXML(ЗаписьXML, ДвоичныеДанные);
	
	Возврат ЗаписьXML.Закрыть();	
	
КонецФункции

&НаКлиенте
Процедура ВывестиТабличныйДокументКакСтроку(ТабДок)
	
	ЗначениеРезультат = ВывестиТабличныйДокументКакСтрокуСервер(ТабДок);
	
КонецПроцедуры 

#КонецОбласти